<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Prototype</title>

    <!-- CSS -->
    <!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/skeleton/2.0.4/skeleton.min.css">-->
    <link rel="stylesheet" href="public/css/style.css">
    <link href="https://fonts.googleapis.com/css?family=Bungee" rel="stylesheet">
</head>
<body class="canvas-wrapper">
  <div class="container">
  </div>
  <script src="https://code.jquery.com/jquery-3.1.1.min.js" crossorigin="anonymous"></script>
  <script>
    $(document).ready(function() {
      var shapeDict = {'american': {'url': '/american', 'shape': [595, 300, 115, 60]},
  'anarchy': {'url': '/agitator/harbor', 'shape': [425, 285, 65, 70]},
  'nonsense': {'url': '#', 'shape': [230, 455, 140, 85]},
  'numerology': {'url': '#', 'shape': [40, 240, 75, 75]},
  'myth': {'url': '#', 'shape': [715, 450, 100, 70]}};
      shapeDict = $.map(shapeDict, (k, v) => { return k; });

      var canvas, ctx, img, width;
      var over = '';

      canvas = document.createElement('canvas');
      ctx = canvas.getContext('2d');
      $('body').prepend(canvas);

      img = new Image();
      img.src = 'public/images/cypher_orig.jpg';
      img.onload = function() {
        resizing();
        $(canvas).on('click', clickRect);
        $(canvas).on('mousemove', checkPos);
      };
      $(window).resize(resizing);

      function clickRect(evt) {
        if(over != '') {
          $(location).attr('href', over);
        }
      }

      function checkPos(evt) {
        for(var i = 0; i < shapeDict.length; i++) {
          var off = $(canvas).offset();
          var sh = shapeDict[i].shape;
          var left = scale(sh[0]) + off.left;
          var right = left + scale(sh[2]) + off.left;
          var top = scale(sh[1]) + off.top;
          var bottom = top + scale(sh[3]) + off.top;
          var cursorStyle = 'default';
          over = '';
          if(evt.clientX > left && evt.clientX < right) {
            if(evt.clientY > top && evt.clientY < bottom) {
              over = shapeDict[i].url;
              console.log(over)
              cursorStyle = 'pointer';
              break;
            }
          }
        }
        $('canvas').css('cursor', cursorStyle);
      }

      function scale(val) {
        return val * width / 1000;
      }

      function drawSquare(arr) {
        ctx.rect(scale(arr[0]), scale(arr[1]), scale(arr[2]), scale(arr[3]));
        ctx.stroke();
      }

      function resizing() {
        canvas.width = document.body.clientWidth;
        width = canvas.width;
        console.log(shapeDict);
        canvas.height = img.height/img.width * canvas.width;
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.drawImage(img, 0, 0, img.width, img.height, 0, 0, canvas.width, canvas.height);
        for(var i = 0; i < shapeDict.length; i++) {
          drawSquare(shapeDict[i].shape);
        }
      }
    });
  </script>
</body>
</html>